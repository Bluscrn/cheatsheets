# Password Hashing using openssl

In order to generate a password I will use openssl

`openssl passwd` is the base command `-1` to specify md5 or `-6` to specify SHA512 `-salt 'XXXX'` to specify a salt `'XXXXXXXX'`  finally add the password.

`openssl passwd -1 -salt 'I_AM_A_SALT' 'I_AM_A_PASSWORD'`

The hash that is generated can be broken down as:

`$1$6VxN$KIkMlzDLjfVgLqKvTXfT30`

`$1` specifies the cipher 1 = md5

`$6VxN` is the salt 6VxN

`$KIkMlzDLjfVgLqKvTXfT30` is the password

the $ is just used as a break

### Brocade passwords are md5 (type 1) with a salt of 3 digits 2 dots and 3 more digits

`openssl passwd -1 -salt 'iU0..Rl3' 'password_here'`

Insert the resulting hash into Brocade CLI as:

`username authuser password 8 $1$iU0..Rl3$40qQu78h/LSAvMbol45M1/`

`openssl passwd -1 -salt 'We0..yY2' 'password_here'`

Insert the resulting hash into Brocade CLI as:

`enable super-user-password 8 $1$We0..yY2$z6edearokotDKDuUvWF1Y0`


### Juniper and PaloAlto passwords are md5 (type 1) with an 8 digit salt

`openssl passwd -1 -salt '0Rr56/RP' 'password_here'`

Insert the resulting hash into JunOS as:

`set system login user authuser class super-user-local`

`set system login user authuser authentication encrypted-password "$1$0Rr56/RP$3XcdF987h4ktCoIh664AI1"`

Palo Alto hash goes into the .xml
```xml
<users>
<entry name="backupadmin">
<phash>$1$bamuphpn$zoYT9P1oTA81UU2T5hFk6.</phash>
<permissions>
<role-based>
<superuser>yes</superuser>
</role-based>
</permissions>
</entry>
<entry name="admin">
<permissions>
<role-based>
<superuser>yes</superuser>
</role-based>
</permissions>
<phash>$1$cxdrnomh$AEjkLfvp6jjdSfJi/Kg8a.</phash>
</entry>
</users>
```

### Cisco uses md5 (type 1) with a 4 digit salt

`openssl passwd -1 -salt '6VxN' 'password_here'`

`username authuser privilege 15 secret 5 $1$6VxN$KIkMlzDLjfVgLqKvTXfT30`

`openssl passwd -1 -salt '7Ftt' 'password_here'`

`enable secret 5 $1$7Ftt$ylPGNvdFL40JRgBfNcnaL/`

### Riverbed uses SHA512 (type 6) with an 8 digit salt

`openssl passwd -6 -salt $(openssl rand -base64 6) 'password_here'`

`username "authuser" password 7 $6$DU+5JLS9$GfORbJkJ0K566rABuaRsjBtHuMX.ucPQPoWR27PVBfbjKy7JJNR3btZVOy.nXllHWrnALhssPkT42CIXqWlOw0`

## Salts can be randomly generated by linux or openssl

`openssl passwd -1 -salt $(dd if=/dev/urandom bs=6 count=1 | base64) ThePassword`

or

`openssl passwd -1 -salt $(openssl rand -base64 6) ThePassword`

both of these commands generate an 8 digit random salt

If you wanted a 4 digit salt

`openssl passwd -1 -salt $(dd if=/dev/urandom bs=3 count=1 | base64) ThePassword`

or

`openssl passwd -1 -salt $(openssl rand -base64 3) ThePassword`

## Testing a password

If a password is generated with: `openssl passwd -6 -salt $(openssl rand -base64 6) 'password_here'`

The result is:

`$6$EoqUptHY$ep.srF47RomDERqYEJwFRl7eOi8oMu155XUOSobYX1BSxenxftFjudUS2a17XRuUf5kaf4l8cuM8.QLLqhBIM1`

If you then try the command again but insert the generated salt `EoqUptHY`, you should get the same hash.

`openssl passwd -6 -salt 'EoqUptHY' 'password_here'`

`$6$EoqUptHY$ep.srF47RomDERqYEJwFRl7eOi8oMu155XUOSobYX1BSxenxftFjudUS2a17XRuUf5kaf4l8cuM8.QLLqhBIM1`